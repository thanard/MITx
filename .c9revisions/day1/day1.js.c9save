{"ts":1370922691664,"silentsave":true,"restoring":false,"patch":[[{"diffs":[[1,"function calculate(text){\n    try{\n        var pattern=/[0-9]*\\.[0-9]+|[0-9]+|\\+|\\-|\\*|\\/|\\(|\\)|sin|cos|tan|log|sqrt/g;\n        var tokens = text.match(pattern);\n        console.log(JSON.stringify(tokens));\n        var val = evaluate(tokens);\n        if (tokens.length!==0){\n            throw \"ill-formed expression\";\n        }else{\n            return String(val);\n        } \n    }\n    catch(err){\n        return err;\n    }\n    //return JSON.stringify(tokens);\n}\n    \n//read operand gets called by evaluate\nfunction read_operand(array){\n    var num=array[0];\n    array.shift();\n    //check if it is an open paren\n    if (num=='('){\n        var temp1=evaluate(array);\n        if(array[0]==')'){\n            array[0]=temp1;\n            num=array[0];\n            array.shift();\n        }else{\n            throw \") is not found\";\n        }\n    }\n    if(num=='-'){\n        num=-read_operand(array);\n    }\n    if(num=='sin'){\n        num=Math.sin(read_operand(array));\n    }\n    if(num=='log'){\n        num=Math.log(read_operand(array));\n    }\n    if(num=='cos'){\n        num=Math.cos(read_operand(array));\n    }\n    if(num=='tan'){\n        num=Math.tan(read_operand(array));\n    }\n    if(isNaN(parseInt(num))){\n        throw \"number expected\";\n    }else{\n        return parseFloat(num);\n    }\n}\n\n//evaluate text in the text field\nfunction evaluate(array){\n    if (array.length === 0){\n        throw \"missing operand\";\n    }else{\n        var value=read_operand(array);\n        //stop either when the array is empty or the next one is a closed paren\n        while(array.length!==0 && array[0]!=')'){\n            var operator = array[0];\n            array.shift();\n            if (array.length===0){\n                throw \"missing operand\";\n            }\n            else if (operator=='+'||operator=='-'||operator=='*'||operator=='/'){\n                var temp=read_operand(array);\n                if (operator=='+'){\n                    value=value+temp;\n                }\n                else if(operator=='-'){\n                    value=value-temp;\n                }\n                else if(operator=='*'){\n                    value=value*temp;\n                }\n                else{\n                    value=value/temp;\n                }\n            }else{\n                throw \"unrecognized operator\";\n            }\n        }\n        return value;\n    }\n}\n\n// function read_term(array){\n//     for(var i=0;i<array.length;i++){\n//         if(array)\n//     }\n// }\nfunction setup_cal(div){\n    var input=$('<input id=\"input1\"></input>',{type:\"text\",size: 50});\n    var output = $('<div></div>');\n    var button = $('<button id=\"button1\">Calculate</button>');\n    button.bind(\"click\",function(){\n        output.text(String(calculate(input.val())));\n    });\n    \n    $(\"#input1\").keyup(function(event){\n        if(event.keyCode==13){\n            $(\"#button1\").click();\n        }\n    })\n    $(div).append(input,button,output);\n}\n// #-id .-class\n$(document).ready(function(){\n   $('.calculator').each(function(){\n       //this refers to the <div> with class calculator\n       setup_cal(this);\n   });\n});"]],"start1":0,"start2":0,"length1":0,"length2":3097}]],"length":3097}
{"ts":1370964547219,"patch":[[{"diffs":[[0,"    "],[-1,"array[0]=temp1;\n            num=array[0]"],[1,"num=temp1"],[0,";\n  "]],"start1":702,"start2":702,"length1":48,"length2":17},{"diffs":[[0,"   }\n}\n\n"],[-1,"// "],[0,"function"]],"start1":2319,"start2":2319,"length1":19,"length2":16},{"diffs":[[0,"y){\n"],[-1,"//"],[0,"    "],[-1," for(var i=0;i<array.length;i++){\n//         if(array)\n//     }\n// "],[1,"var newarray;\n    while(array)\n"],[0,"}\nfu"]],"start1":2350,"start2":2350,"length1":81,"length2":43}]],"length":3025,"saved":false}
{"ts":1370964615286,"patch":[[{"diffs":[[0,"warray;\n"],[1,"    \n"],[0,"    whil"]],"start1":2364,"start2":2364,"length1":16,"length2":21},{"diffs":[[0,"le(array"],[-1,")"],[1,".length!==0 && array[0]!=')'){\n            var operator = array[0];\n            array.shift();\n            if (array.length===0){\n                throw \"missing operand\";\n            }\n            else if (operator=='+'||operator=='-'||operator=='*'||operator=='/'){\n                var temp=read_operand(array);\n                if (operator=='+'){\n                    value=value+temp;\n                }\n                else if(operator=='-'){\n                    value=value-temp;\n                }\n                else if(operator=='*'){\n                    value=value*temp;\n                }\n                else{\n                    value=value/temp;\n                }\n            }else{\n                throw \"unrecognized operator\";\n            }"],[0,"\n}\nfunct"]],"start1":2384,"start2":2384,"length1":17,"length2":770}]],"length":3783,"saved":false}
{"ts":1370964972909,"patch":[[{"diffs":[[0,"newarray"],[1,"=[]"],[0,";\n    "],[-1,"\n"],[1,"if (array.length === 0){\n        throw \"missing operand\";\n    }else{\n        var value=read_operand(array);\n        newarray=[value];\n    "],[0,"    whil"]],"start1":2362,"start2":2362,"length1":23,"length2":163},{"diffs":[[0,"'){\n            "],[1,"   "],[1," "],[0,"var operator = a"]],"start1":2559,"start2":2559,"length1":32,"length2":36},{"diffs":[[0,"0];\n            "],[1,"    "],[0,"array.shift();\n "]],"start1":2600,"start2":2600,"length1":32,"length2":36},{"diffs":[[0,"();\n            "],[1,"  "],[1,"  "],[0,"if (array.length"]],"start1":2631,"start2":2631,"length1":32,"length2":36},{"diffs":[[0,"ay.length===0){\n"],[1,"    "],[0,"                "]],"start1":2658,"start2":2658,"length1":32,"length2":36},{"diffs":[[0,"d\";\n            "],[-1,"}\n"],[1,"    }\n    "],[0,"            else"]],"start1":2715,"start2":2715,"length1":34,"length2":42},{"diffs":[[0,"r=='"],[-1,"+'||operator=='-'||operator=='"],[0,"*'||"]],"start1":2769,"start2":2769,"length1":38,"length2":8},{"diffs":[[0,"operator=='/'){\n"],[1,"    "],[0,"                "]],"start1":2777,"start2":2777,"length1":32,"length2":36},{"diffs":[[0,"    "],[-1,"            if (operator=='+'){\n                    value=value+temp;\n                }\n"],[0,"    "]],"start1":2843,"start2":2843,"length1":96,"length2":8},{"diffs":[[0,"e if(operator=='"],[-1,"-"],[1,"*"],[0,"'){\n"],[1,"    "],[0,"                "]],"start1":2866,"start2":2866,"length1":37,"length2":41},{"diffs":[[0,"     value=value"],[-1,"-"],[1,"*"],[0,"temp;\n          "]],"start1":2906,"start2":2906,"length1":33,"length2":33},{"diffs":[[0,"    "],[-1,"   }\n"],[0,"       "],[-1,"         else if(operator=='*'){\n                    value=value*temp;\n                }\n                else{\n"],[1,"}\n                    else{\n    "],[0,"    "]],"start1":2938,"start2":2938,"length1":131,"length2":47},{"diffs":[[0,"                "],[-1,"}\n"],[1,"    }\n  "],[0,"            }els"]],"start1":3019,"start2":3019,"length1":34,"length2":40},{"diffs":[[0,"}\n              "],[1,"  "],[0,"}else{\n"],[1,"    "],[0,"                "]],"start1":3039,"start2":3039,"length1":39,"length2":45},{"diffs":[[0,"r\";\n        "],[1,"        }\n        }\n"],[0,"    }\n}\nfunc"]],"start1":3111,"start2":3111,"length1":24,"length2":44}]],"length":3785,"saved":false}
{"ts":1370965128388,"patch":[[{"diffs":[[0,"   }\n}\n\n"],[1,"//to read first time to evaluate everything except +,-, numbers\n"],[0,"function"]],"start1":2319,"start2":2319,"length1":16,"length2":80},{"diffs":[[0,"              }\n"],[1,"                }else if(operator=='+'||operator=='-'){\n                        newarray.push(operator);\n"],[0,"                "]],"start1":3089,"start2":3089,"length1":32,"length2":137}]],"length":3954,"saved":false}
{"ts":1370965160350,"patch":[[{"diffs":[[0,"                "],[-1,"else "],[0,"if(operator=='*'"]],"start1":2911,"start2":2911,"length1":37,"length2":32}]],"length":3949,"saved":false}
{"ts":1370965293237,"patch":[[{"diffs":[[0,"warray=["],[-1,"value"],[0,"];\n     "]],"start1":2561,"start2":2561,"length1":21,"length2":16},{"diffs":[[0,"              }\n"],[1,"                    newarray.push(operator);\n"],[0,"                "]],"start1":3079,"start2":3079,"length1":32,"length2":77}]],"length":3989,"saved":false}
{"ts":1370965305424,"patch":[[{"diffs":[[0,"warray.push("],[-1,"operator"],[1,"value"],[0,");\n         "]],"start1":3117,"start2":3117,"length1":32,"length2":29}]],"length":3986,"saved":false}
{"ts":1370965327262,"patch":[[{"diffs":[[0,"operator=='-'){\n"],[1,"                        newarray.push(value);\n"],[0,"                "]],"start1":3177,"start2":3177,"length1":32,"length2":78}]],"length":4032,"saved":false}
{"ts":1370965981527,"patch":[[{"diffs":[[0,"  newarray.push("],[-1,"value"],[1,"operator"],[0,");\n             "]],"start1":3215,"start2":3215,"length1":37,"length2":40},{"diffs":[[0,"    "],[-1,"newarray.push(operator);"],[1,"var temp=read_operand(array);\n                        "],[0,"\n   "]],"start1":3262,"start2":3262,"length1":32,"length2":62}]],"length":4065,"saved":false}
{"ts":1370965995358,"patch":[[{"diffs":[[0,"            "],[1,"newarray.push(temp);"],[0,"\n           "]],"start1":3308,"start2":3308,"length1":24,"length2":44}]],"length":4085,"saved":false}
{"contributors":[],"silentsave":false,"ts":1370977364592,"patch":[[{"diffs":[[0,"  newarray=["],[1,"value"],[0,"];\n        w"]],"start1":2557,"start2":2557,"length1":24,"length2":29},{"diffs":[[0,"    }\n}\n"],[1,"\n"],[0,"function"]],"start1":3448,"start2":3448,"length1":16,"length2":17}]],"length":4091,"saved":false}
{"ts":1370977436847,"patch":[[{"diffs":[[0,"se{\n"],[-1,"        var value=read_operand(array);\n        newarray=[value];\n"],[0,"    "]],"start1":2508,"start2":2508,"length1":73,"length2":8},{"diffs":[[0,"        var "],[-1,"operator"],[1,"next"],[0," = array[0];"]],"start1":2570,"start2":2570,"length1":32,"length2":28},{"diffs":[[0,"lse if ("],[-1,"operator=='*'||operator"],[1,")\n                else if (next=='*'||next"],[0,"=='/'){\n"]],"start1":2749,"start2":2749,"length1":39,"length2":58},{"diffs":[[0,"         if("],[-1,"operator"],[1,"next"],[0,"=='*'){\n    "]],"start1":2868,"start2":2868,"length1":32,"length2":28},{"diffs":[[0,"else if("],[-1,"operator=='+'||operator"],[1,"next=='+'||next"],[0,"=='-'){\n"]],"start1":3105,"start2":3105,"length1":39,"length2":31},{"diffs":[[0,"ush("],[-1,"operator);\n                        var temp=read_operand(array);\n                        newarray.push(temp"],[1,"next"],[0,");\n "]],"start1":3170,"start2":3170,"length1":115,"length2":12}]],"length":3926,"saved":false}
{"ts":1370977468195,"patch":[[{"diffs":[[0,"t = "],[-1,"array[0];\n                array.shift("],[1,"read_operand(array"],[0,");\n "]],"start1":2585,"start2":2585,"length1":46,"length2":26}]],"length":3906,"saved":false}
{"ts":1370977655612,"patch":[[{"diffs":[[0,"lse if ("],[-1,")"],[1,"/[0-9]*\\.[0-9]+|[0-9]+/.test(next)){\n                    \n                }"],[0,"\n       "]],"start1":2729,"start2":2729,"length1":17,"length2":91}]],"length":3980,"saved":false}
{"ts":1370977677180,"patch":[[{"diffs":[[0,"            "],[1,"newarray.push(next);"],[0,"\n           "]],"start1":2782,"start2":2782,"length1":24,"length2":44}]],"length":4000,"saved":false}
{"ts":1370977714758,"patch":[[{"diffs":[[0,"            var "],[-1,"temp"],[1,"nextnext"],[0,"=read_operand(ar"]],"start1":2889,"start2":2889,"length1":36,"length2":40}]],"length":4004,"saved":false}
{"ts":1370977727104,"patch":[[{"diffs":[[0,"var "],[-1,"nextnext"],[1,"temp"],[0,"=rea"]],"start1":2901,"start2":2901,"length1":16,"length2":12}]],"length":4000,"saved":false}
{"ts":1370977746482,"patch":[[{"diffs":[[0,"          value="],[-1,"value"],[1,"newarray[newarray.length-1]"],[0,"*temp;\n         "]],"start1":2980,"start2":2980,"length1":37,"length2":59}]],"length":4022,"saved":false}
{"ts":1370977805730,"patch":[[{"diffs":[[0,"        "],[-1,"value"],[1,"toadd"],[0,"=newarra"]],"start1":2982,"start2":2982,"length1":21,"length2":21},{"diffs":[[0,"            "],[-1,"value=value"],[1,"toadd=newarray[newarray.length-1]"],[0,"/temp;\n     "]],"start1":3090,"start2":3090,"length1":35,"length2":57}]],"length":4044,"saved":false}
{"ts":1370977820688,"patch":[[{"diffs":[[0,"ay.push("],[-1,"value"],[1,"toadd"],[0,");\n     "]],"start1":3190,"start2":3190,"length1":21,"length2":21}]],"length":4044,"saved":false}
{"ts":1370977833427,"patch":[[{"diffs":[[0,"                "],[1,"var "],[0,"toadd=newarray[n"]],"start1":2974,"start2":2974,"length1":32,"length2":36},{"diffs":[[0,"        "],[1,"var "],[0,"toadd=ne"]],"start1":3098,"start2":3098,"length1":16,"length2":20}]],"length":4052,"saved":false}
{"ts":1370977877031,"patch":[[{"diffs":[[0,"            "],[-1,"var toadd="],[1,"newarray.push("],[0,"newarray[new"]],"start1":2978,"start2":2978,"length1":34,"length2":38},{"diffs":[[0,"ngth-1]*temp"],[1,")"],[0,";\n          "]],"start1":3024,"start2":3024,"length1":24,"length2":25},{"diffs":[[0," var"],[-1," toadd="],[1,"newarray.push("],[0,"newa"]],"start1":3110,"start2":3110,"length1":15,"length2":22},{"diffs":[[0,"ngth-1]/temp"],[1,")"],[0,";\n          "]],"start1":3148,"start2":3148,"length1":24,"length2":25}]],"length":4065,"saved":false}
{"ts":1370977878982,"patch":[[{"diffs":[[0,"        "],[-1,"var"],[0,"newarray"]],"start1":3103,"start2":3103,"length1":19,"length2":16}]],"length":4062,"saved":false}
{"ts":1370977914080,"patch":[[{"diffs":[[0,"ngth!==0"],[-1," && array[0]!=')'"],[0,"){\n     "]],"start1":2534,"start2":2534,"length1":33,"length2":16}]],"length":4045,"saved":false}
{"ts":1370977997339,"patch":[[{"diffs":[[0,"}\n    }\n"],[1,"    return evaluate(newarray);\n"],[0,"}\n\nfunct"]],"start1":3400,"start2":3400,"length1":16,"length2":47}]],"length":4076,"saved":false}
{"ts":1370978011015,"patch":[[{"diffs":[[0,"r val = "],[-1,"evaluate"],[1,"read_term"],[0,"(tokens)"]],"start1":217,"start2":217,"length1":24,"length2":25}]],"length":4077,"saved":false}
{"ts":1370978038764,"patch":[[{"diffs":[[0,"    }\n    }\n"],[1,"    console.log(newarray);\n"],[0,"    return e"]],"start1":3397,"start2":3397,"length1":24,"length2":51}]],"length":4104,"saved":false}
{"ts":1370978152717,"patch":[[{"diffs":[[0,"  }\n"],[-1,"                    newarray.push(toadd);\n"],[0,"    "]],"start1":3162,"start2":3162,"length1":50,"length2":8}]],"length":4062,"saved":false}
{"ts":1370978388956,"patch":[[{"diffs":[[0,"n);\n        "],[1,"//"],[0,"console.log("]],"start1":158,"start2":158,"length1":24,"length2":26}]],"length":4064,"saved":false}
{"ts":1370978446777,"patch":[[{"diffs":[[0," next = "],[-1,"read_operand(array"],[1,"array[0];\n                array.shift("],[0,");\n     "]],"start1":2567,"start2":2567,"length1":34,"length2":54}]],"length":4084,"saved":false}
{"ts":1370978507797,"patch":[[{"diffs":[[0,"            "],[-1,"newarray.push("],[1,"var temp1="],[0,"newarray[new"]],"start1":2984,"start2":2984,"length1":38,"length2":34},{"diffs":[[0,"ength-1]"],[1,";\n                        newarray.pull();\n                        newarray.push(temp1"],[0,"*temp);\n"]],"start1":3025,"start2":3025,"length1":16,"length2":102}]],"length":4166,"saved":false}
{"ts":1370978543851,"patch":[[{"diffs":[[0,"ay.p"],[-1,"ull"],[1,"op"],[0,"();\n"]],"start1":3065,"start2":3065,"length1":11,"length2":10}]],"length":4165,"saved":false}
{"ts":1370978569923,"patch":[[{"diffs":[[0,"        "],[-1,"newarray.push("],[1,"var temp2="],[0,"newarray"]],"start1":3190,"start2":3190,"length1":30,"length2":26},{"diffs":[[0,"ength-1]"],[1,";\n                        newarray.pop();\n                        newarray.push(temp2"],[0,"/temp);\n"]],"start1":3227,"start2":3227,"length1":16,"length2":101}]],"length":4246,"saved":false}
{"contributors":[],"silentsave":true,"ts":1371064736776,"patch":[[{"diffs":[[0,"       }"],[-1," "],[0,"\n    }\n "]],"start1":369,"start2":369,"length1":17,"length2":16},{"diffs":[[0,"input1\">"],[1,"sdfa"],[0,"</input>"]],"start1":3664,"start2":3664,"length1":16,"length2":20}]],"length":4249,"saved":false}
{"ts":1371064746810,"patch":[[{"diffs":[[0,"t1\">"],[-1,"sdfa"],[0,"</in"]],"start1":3668,"start2":3668,"length1":12,"length2":8}]],"length":4245,"saved":false}
